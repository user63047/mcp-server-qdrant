services:
  mcp-server-qdrant:
    image: ghcr.io/user63047/mcp-server-qdrant:feature-container-deployment
    container_name: mcp-server-qdrant
    restart: unless-stopped
    ports:
      - "192.168.1.170:8000:8000"
    networks:
      - ollama-webui-network
    environment:
      # --- Embedding ---
      - EMBEDDING_PROVIDER=ollama
      - EMBEDDING_MODEL=embeddinggemma:300m
      - OLLAMA_URL=http://ollama:11434
      # --- Summary ---
      - SUMMARY_MODEL=${SUMMARY_MODEL:-}
      - SUMMARY_PROVIDER=ollama
      # --- Qdrant ---
      - QDRANT_URL=http://qdrant:6333
      - QDRANT_API_KEY=${QDRANT_API_KEY:?Qdrant API key required}
      - COLLECTION_NAME=${COLLECTION_NAME:-}
      - QDRANT_SEARCH_LIMIT=10
      - QDRANT_READ_ONLY=false
      # --- Chunking ---
      - CHUNK_SIZE=1500
      - CHUNK_OVERLAP=375
    healthcheck:
      test: ["CMD", "python", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:8000/api/v1/health')"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 15s

networks:
  ollama-webui-network:
    name: ollama-webui-network
    external: true
